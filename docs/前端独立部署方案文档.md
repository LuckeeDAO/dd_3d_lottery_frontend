# DD 3D 彩票前端独立部署方案

## 🎯 方案概述

将DD 3D彩票系统的前端从当前项目中分离，创建独立的GitHub仓库并部署到Vercel。

## 📋 实施步骤

### 步骤1：创建独立前端仓库

```bash
# 1. 创建新的GitHub仓库
# 在GitHub上创建新仓库：dd-3d-lottery-frontend

# 2. 克隆当前项目
git clone https://github.com/your-org/dd-3d-lottery.git temp-repo
cd temp-repo

# 3. 创建前端独立分支
git checkout -b frontend-separation

# 4. 只保留前端相关文件
rm -rf backend/ docs/ README.md
mv front/* .
rmdir front

# 5. 更新根目录文件
mv front/README.md README.md
mv front/package.json package.json
mv front/vercel.json vercel.json
# ... 移动其他前端文件

# 6. 更新README.md
cat > README.md << 'EOF'
# DD 3D 彩票前端

基于 React + TypeScript + Vite 的现代化 Web 前端应用。

## 快速开始

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build
```

## 部署

### Vercel 部署

```bash
# 安装 Vercel CLI
npm install -g vercel

# 部署到预览环境
vercel

# 部署到生产环境
vercel --prod
```

## 环境变量

- `VITE_CHAIN_ID`: 区块链网络ID
- `VITE_RPC_URL`: RPC节点URL
- `VITE_CONTRACT_ADDRESS`: 智能合约地址
- `VITE_SENDER_ADDRESS`: 发送者地址
EOF

# 7. 提交到新仓库
git add .
git commit -m "feat: separate frontend from monorepo"
git remote set-url origin https://github.com/your-org/dd-3d-lottery-frontend.git
git push -u origin frontend-separation
```

### 步骤2：配置Vercel部署

```bash
# 1. 安装Vercel CLI
npm install -g vercel

# 2. 登录Vercel
vercel login

# 3. 初始化项目
vercel

# 4. 配置环境变量
vercel env add VITE_CHAIN_ID production
vercel env add VITE_RPC_URL production
vercel env add VITE_CONTRACT_ADDRESS production
vercel env add VITE_SENDER_ADDRESS production

# 5. 部署
vercel --prod
```

### 步骤3：更新原项目结构

```bash
# 在原项目中更新README.md
cat > README.md << 'EOF'
# DD 3D 彩票系统

基于 CosmWasm 的去中心化 3D 彩票系统，采用前后端分离架构。

## 项目结构

```
dd_3d_lottery/
├── backend/           # 后端 - CosmWasm 智能合约
│   ├── src/          # 合约源代码
│   ├── tests/        # 合约测试
│   └── Cargo.toml    # Rust 项目配置
└── docs/             # 项目文档
```

## 前端项目

前端项目已独立部署：
- **仓库**: https://github.com/your-org/dd-3d-lottery-frontend
- **部署**: https://dd-3d-lottery.vercel.app

## 后端开发

```bash
cd backend
cargo build
cargo test
./scripts/deploy.sh
```
EOF
```

## 🔧 技术配置

### Vercel配置优化

```json
// vercel.json
{
  "version": 2,
  "name": "dd-3d-lottery-frontend",
  "builds": [
    {
      "src": "package.json",
      "use": "@vercel/static-build",
      "config": {
        "distDir": "dist"
      }
    }
  ],
  "routes": [
    {
      "src": "/(.*)",
      "dest": "/index.html"
    }
  ],
  "headers": [
    {
      "source": "/(.*)",
      "headers": [
        {
          "key": "X-Content-Type-Options",
          "value": "nosniff"
        },
        {
          "key": "X-Frame-Options",
          "value": "DENY"
        },
        {
          "key": "X-XSS-Protection",
          "value": "1; mode=block"
        }
      ]
    },
    {
      "source": "/static/(.*)",
      "headers": [
        {
          "key": "Cache-Control",
          "value": "public, max-age=31536000, immutable"
        }
      ]
    }
  ],
  "functions": {
    "api/**/*.ts": {
      "runtime": "nodejs18.x"
    }
  }
}
```

### 环境变量配置

```bash
# .env.local (本地开发)
VITE_CHAIN_ID=cosmoshub-4
VITE_RPC_URL=https://rpc.cosmos.network
VITE_CONTRACT_ADDRESS=cosmwasm1contract...
VITE_SENDER_ADDRESS=cosmwasm1sender...

# .env.production (生产环境)
VITE_CHAIN_ID=cosmoshub-4
VITE_RPC_URL=https://rpc.cosmos.network
VITE_CONTRACT_ADDRESS=cosmwasm1contract...
VITE_SENDER_ADDRESS=cosmwasm1sender...
```

## 📈 优势分析

### 1. 开发效率提升
- **独立构建**: 前端构建时间从5分钟减少到2分钟
- **并行开发**: 前后端团队可以独立工作
- **快速迭代**: 前端可以独立发布版本

### 2. 部署优化
- **独立部署**: 前端更新不影响后端
- **CDN加速**: Vercel全球CDN网络
- **自动部署**: Git推送自动触发部署

### 3. 团队协作
- **权限管理**: 前端团队独立权限
- **代码审查**: 专注前端代码质量
- **问题追踪**: 独立的问题管理

### 4. 技术栈优化
- **依赖管理**: 前端专用依赖
- **构建工具**: 优化的Vite配置
- **测试策略**: 前端专用测试

## 🚀 部署流程

### 开发环境
```bash
# 前端开发
cd dd-3d-lottery-frontend
npm run dev

# 后端开发
cd dd-3d-lottery/backend
cargo run
```

### 生产部署
```bash
# 前端部署
cd dd-3d-lottery-frontend
vercel --prod

# 后端部署
cd dd-3d-lottery/backend
./scripts/deploy.sh
```

## 📊 成本分析

### 当前方案（单体仓库）
- **构建时间**: 5-8分钟
- **部署频率**: 每次全量部署
- **团队协作**: 代码冲突风险

### 独立仓库方案
- **构建时间**: 2-3分钟
- **部署频率**: 按需独立部署
- **团队协作**: 并行开发

## 🎯 实施时间表

### 第1天：仓库分离
- [ ] 创建独立前端仓库
- [ ] 迁移前端代码
- [ ] 更新文档

### 第2天：Vercel部署
- [ ] 配置Vercel项目
- [ ] 设置环境变量
- [ ] 测试部署

### 第3天：优化配置
- [ ] 优化构建配置
- [ ] 设置CI/CD
- [ ] 性能测试

## 🔄 回滚方案

如果需要回滚到单体仓库：

```bash
# 1. 恢复原项目结构
git checkout main
git merge frontend-separation

# 2. 删除独立仓库
# 在GitHub上删除独立仓库

# 3. 恢复部署配置
# 恢复原有的部署流程
```

## 📚 相关文档

- [Vercel部署指南](部署指南.md)
- [前端开发指南](../front/README.md)
- [后端开发指南](../backend/README.md)

---

**DD 3D 彩票前端独立部署方案** - 现代化、高效、可维护的前端部署解决方案 🚀
